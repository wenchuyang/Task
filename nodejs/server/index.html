<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Nodejs Test</title>
</head>

<body>
  <!DOCTYPE html>
  <html lang="en">

  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
  </head>

  <body>
    <p> 我，秦始皇，打钱。你的余额为<span id="amount">&&&amount&&&</span> </p>
    <input type="submit" value="付款一元" id="button">
    <script>
      var httpRequest = new XMLHttpRequest();
      document.getElementById("button").addEventListener("click", function () {
        httpRequest.open('POST', '/pay', true);
        httpRequest.setRequestHeader("Content-type", "application/json");
        const obj = {
          "amount": "1"
        }
        httpRequest.send(JSON.stringify(obj));
        httpRequest.onreadystatechange = function () {
          if (httpRequest.readyState == 4 && httpRequest.status == 200) {
            let jsonStr = httpRequest.responseText;
            let json = JSON.parse(jsonStr)
            if (json.success) {
              document.getElementById("amount").innerText = json.money
            } else {
              alert("打款姿势不对，请倒立打款")
            }
          }
        };
      })
    </script>
  </body>

  </html>
</body>

</html>